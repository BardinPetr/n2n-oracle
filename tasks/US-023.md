## US-023 Контракт моста: отключение моста

**Описание**: Я, как администратор моста, хочу иметь возможность остановить все пользовательские опреации по передаче средств через мост. Например, это может быть использовано, если в контрактах обнаружена ошибка и необходимо обновление.

В данной US подразумевается, что ABI контрактов мостов изменяется. Добавляются следуюшие методы в контракты моста:
   * метод `stopOperations()` переводит контракт моста в такое состояние при котором любые пользовательские транзакции на перевод средств контракту моста завершают свое исполнение операцией `revert`.
   * метод `startOperations()` возвращает контракт в работоспособное состояние.

В тестах, перечисленных ниже, за исключением случаев, где это специально оговорено, считается, что 

1. Существуют две блокчейн сети:
    * Сеть `LEFT`:
      - максимальное количество газа, которое может быть потрачено транзакциями  в блоке `12'500'000`
      - время выпуска блоков в среднем раз в 5 секунд
      - контракт моста находится по адресу `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`
    * Сеть `RIGHT`:
      - максимальное количество газа, которое может быть потрачено транзакциями  в блоке `12'500'000`
      - время выпуска блоков в среднем раз в 5 секунд
      - контракт моста находится по адресу `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`

2. Контракты моста зарегистрированы в блокчейн сетях при следующем содержимом переменных окружения:

    ```
    VALIDATORS=0xaF1E1D6C3cedD99DA7df3a91F5B956AB6d2eC3Fc
    THRESHOLD=1
    ```

3. Установлена ликвидность моста в 2000 токенов.

### AC-023-01 Отключение моста

1. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` отправляет 50 нативных токенов на адрес `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`. Транзакция исполняется успешно. Баланс пользователя уменьшается на 50 токенов. Баланс моста увеличивается на 50 токенов.
   
2. Администратор моста отправляет в контракт `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441` транзакцию, вызывающую метод `stopOperations`. Транзакция исполняется успешно.

3. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на пересылку 50 нативных токенов на адрес `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

4. Аккаунт с адресом `0xaF1E1D6C3cedD99DA7df3a91F5B956AB6d2eC3Fc` отправляет транзакцию на контракт `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`, вызывающую метод `commit` с параметром `("0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e", 5000000000000000000, "0x1f4e6e8d2e4b34a3fd4df3b9ae91b3cf4cf129b089a2700e633cdeb3ea575c85")`. Транзакция исполняется успешно. У пользователя `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` после исполнения транзакции становится на 5 нативных токенов больше. Баланс контракта моста меняется на 5 нативных токенов.

5. Администратор моста отправляет в контракт `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441` транзакцию, вызывающую метод `startOperations`. Транзакция исполняется успешно.

6. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` отправляет 50 нативных токенов на адрес `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`. Транзакция исполняется успешно. Баланс пользователя уменьшается на 50 токенов. Баланс моста увеличивается на 50 токенов.

7. Аккаунт с адресом `0xaF1E1D6C3cedD99DA7df3a91F5B956AB6d2eC3Fc` отправляет транзакцию на контракт `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`, вызывающую метод `commit` с параметром `("0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Транзакция исполняется успешно. У пользователя `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` после исполнения транзакции становится на 50 нативных токенов больше. Баланс контракта моста меняется до 50 нативных токенов.

8. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` отправляет 5 нативных токенов на адрес `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`. Транзакция исполняется успешно. Баланс пользователя уменьшается на 5 токенов. Баланс моста увеличивается на 5 токенов.
   
9. Администратор моста отправляет в контракт `0x159AE4d7012B18A0dE4e390714a6efa036487f0b` транзакцию, вызывающую метод `stopOperations`. Транзакция исполняется успешно.

10. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на пересылку 5 нативных токенов на адрес `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

11. Аккаунт с адресом `0xaF1E1D6C3cedD99DA7df3a91F5B956AB6d2eC3Fc` отправляет транзакцию на контракт `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`, вызывающую метод `commit` с параметром `("0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e", 50000000000000000000, "0x930650054b50608dafb24c08b71f46bf8605de83d9ad5502cad0c6159dd074bf")`. Транзакция исполняется успешно. У пользователя `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` после исполнения транзакции становится на 50 нативных токенов больше. Баланс контракта моста меняется до 50 нативных токенов.

12. Администратор моста отправляет в контракт `0x159AE4d7012B18A0dE4e390714a6efa036487f0b` транзакцию, вызывающую метод `startOperations`. Транзакция исполняется успешно.

13. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` отправляет 5 нативных токенов на адрес `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`. Транзакция исполняется успешно. Баланс пользователя уменьшается на 5 токенов. Баланс моста увеличивается на 5 токенов.

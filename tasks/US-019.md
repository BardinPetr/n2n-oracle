## US-019 Оракул: экономичная посылка подтверждений в левую сторону

**Описание**: Я, как пользователь моста, могу ожидать, что после переключения в режим экономичной пересылки оракулы продолжат переправлять подтверждения об пересылке токенов через мост. При этом количество транзакций от оракулов в левую сеть значительно уменьшится.

В тестах, перечисленных ниже, за исключением случаев, где это специально оговорено, считается, что 

1. Существуют две блокчейн сети:
    * Сеть `LEFT`:
      - максимальное количество газа, которое может быть потрачено транзакциями  в блоке `12'500'000`
      - время выпуска блоков в среднем раз в 5 секунд
      - контракт моста находится по адресу `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`
    * Сеть `RIGHT`:
      - максимальное количество газа, которое может быть потрачено транзакциями  в блоке `12'500'000`
      - время выпуска блоков в среднем раз в 5 секунд
      - контракт моста находится по адресу `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`

2. Контракты моста зарегистрированы в блокчейн сетях при следующем содержимом переменных окружения:

    ```
    VALIDATORS=0x226Dbd003697a5Ab7A501ED6fc02Bda096C66E70 0x130930e3E3D30bF8F975a729e948CdCc212ECFBB 0x61365C58E44A6Fc166897f4A30641dba82E606c0
    THRESHOLD=2
    ```

3. Установлена ликвидность моста в 1000 токенов. 

4. На двух сторонах моста выполнена команда `enableRobustMode`.

5. Запущены три оракула. В `PRIVKEY` `.env`-файла каждого оракула указан свой собственный приватный ключ, который соответствует одному из адресов, перечисленных в `VALIDATORS` при регистрации контрактов моста. Порядок запуска оракулов не определен. Промежутки времени между запусками оракулов не определены. 

### AC-019-01 Пересылка токенов

1. Пользователь, чей приватный ключ соответствует адресу `0x5580ba66f8d6dc71adb0ca1d1c6b3d142ff7aaca` отправляет 1000 нативных токенов на адрес `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`. Транзакция входит в блок `B` и исполняется успешно. Баланс пользователя в сети `LEFT` уменьшается на 1000 токенов. Баланс моста увеличивается до 1000 токенов.
   
   В сети `RIGHT` в одном или нескольких блоках, выпущенном не позднее чем через 15 секунд после появления блока `B`, есть транзакции от двух или трех оракулов. При опросе баланса пользователя `0x5580ba66f8d6dc71adb0ca1d1c6b3d142ff7aaca` в сети `RIGHT` на момент завершения блока, в который включена последняя успешная транзакция от оракулов, видно, что на 1000 нативных токенов стало больше. При аналогичном запросе для баланса моста видно его уменьшение до 0 нативных токенов.

2. Пользователь, чей приватный ключ соответствует адресу `0x5580ba66f8d6dc71adb0ca1d1c6b3d142ff7aaca` отправляет `X` (0.001 < X < 50) нативных токенов на адрес `0x159AE4d7012B18A0dE4e390714a6efa036487f0b`. Транзакция `0xac21bd9c034f02266f79ac064560ea1ed3e8b8ff6491f0f8e433e9122ae4e804` входит в блок `B*` и исполняется успешно. Баланс пользователя в сети `RIGHT` уменьшается на `X` токенов. Баланс моста увеличивается на `X` токенов.
   
3. В сети `RIGHT` в одном из блоков `B**`, выпущенном не позднее через 15 секунд после того, как выпущен блок `B*`, есть транзакции от оракулов. В выписке одной из транзакции есть событие:
    * `commitsCollected("0xac21bd9c034f02266f79ac064560ea1ed3e8b8ff6491f0f8e433e9122ae4e804", 2)`

4. В сети `LEFT` в блоке, выпущенном не позднее чем через 15 секунд после появления блока `B**`, есть транзакция от одного из оракулов и нет транзакций от других. При опросе баланса пользователя `0x5580ba66f8d6dc71adb0ca1d1c6b3d142ff7aaca` в сети `LEFT` на момент завершения блока, в который включена транзакция оракула, видно, что на `X` нативных токенов стало больше. При аналогичном запросе для баланса моста видно его уменьшение на `X` нативных токенов.

5. Пользователь, чей приватный ключ соответствует адресу `0x97bdb4071396b7f60b65e0eb62ce212a699f4b08` отправляет `Y` (0.001 < Y < 50) нативных токенов на адрес `0xfab1ed72a7236a6b34f47ee7Ed103d6CD448c441`. Транзакция входит в блок `B***` и исполняется успешно. Баланс пользователя в сети `LEFT` уменьшается на `Y` токенов. Баланс моста увеличивается на `Y` токенов.
   
   В сети `RIGHT` в одном или нескольких блоках, выпущенном не позднее чем через 15 секунд после появления блока `B***`, есть транзакции от двух или трех оракулов. При опросе баланса пользователя `0x97bdb4071396b7f60b65e0eb62ce212a699f4b08` в сети `RIGHT` на момент завершения блока, в который включена последняя успешная транзакция от оракулов, видно, что на `Y` нативных токенов стало больше. При аналогичном запросе для баланса моста видно его уменьшение на `Y` нативных токенов.

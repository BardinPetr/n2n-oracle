## US-011 Контракт моста: отправка подтверждения от валидатора на левую сторону

**Описание**: Я, как валидатор моста, могу подтвердить посылку нативных токенов из правой стороны моста в левую сторону, послав соответствующее сообщение в контракт моста на левой стороне.

### AC-011-01 1 of 1

1. Контракт моста зарегистрирован в блокчейн сети с левой стороны по адресу `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` при следующем содержимом переменных окружения:

    ```
    VALIDATORS=0x130930e3E3D30bF8F975a729e948CdCc212ECFBB
    THRESHOLD=1
    ```

2. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

3. Администратор моста инициирует контракт моста, отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `updateLiquidityLimit` с параметром `(100000000000000000000)`.

4. Вызов метода `getLiquidityLimit` у контракта `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` возвращает: `100000000000000000000`.

5. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

4. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` отправляет 75 нативных токенов на адрес контракта моста. Транзакция исполняется успешно. Баланс пользователя уменьшается на 75 токенов. Баланс моста увеличивается до 75 токенов. В выписке транзакции есть событие:
    * `bridgeActionInitiated("0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e", 75000000000000000000)`

6. Вызов метода `getLiquidityLimit` у контракта `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` возвращает: `25000000000000000000`.

5. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Транзакция исполняется успешно. У пользователя `0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd` после исполнения транзакции становится на 50 нативных токенов больше. Баланс контракта моста меняется до 25 нативных токенов.

6. Вызов метода `getLiquidityLimit` у контракта `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` возвращает: `75000000000000000000`.

7. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 26000000000000000000, "0xbe4da129fc927472b7b5ab00c04a0c19124fd3915a51650e672f332dcc8d2f3d")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

8. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xC1d9971bcd39bd96f64787765221be86d1a928e5", 5000000000000000000, "0xbe4da129fc927472b7b5ab00c04a0c19124fd3915a51650e672f332dcc8d2f3d")`. Транзакция исполняется успешно. У пользователя `0xC1d9971bcd39bd96f64787765221be86d1a928e5` после исполнения транзакции становится на 5 нативных токенов больше. Баланс контракта моста меняется до 20 нативных токенов.

9. Вызов метода `getLiquidityLimit` у контракта `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` возвращает: `80000000000000000000`.

10. Аккаунт с адресом `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0x737b791E227f0395d39F7496198F9EC751A57Dc0", 5000000000000000000, "0x5840f306777b4982348202e3ff40c17e6ae555b228d5f0290aa23c23d36423d1")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

11. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xC1d9971bcd39bd96f64787765221be86d1a928e5", 5000000000000000000, "0x5d46b2de62ae6807ad8a2cf1342b2b7bf547328f23a5439511297798b9cadfbc")`. Транзакция исполняется успешно. У пользователя `0xC1d9971bcd39bd96f64787765221be86d1a928e5` после исполнения транзакции становится на 5 нативных токенов больше. Баланс контракта моста меняется до 15 нативных токенов.

12. Вызов метода `getLiquidityLimit` у контракта `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` возвращает: `85000000000000000000`.

13. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0xC1d9971bcd39bd96f64787765221be86d1a928e5", 5000000000000000000, "0x5d46b2de62ae6807ad8a2cf1342b2b7bf547328f23a5439511297798b9cadfbc")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

### AC-011-2 N of M

1. Контракт моста зарегистрирован в блокчейн сети с правой стороны по адресу `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e` при следующем содержимом переменных окружения:

    ```
    VALIDATORS=0x226Dbd003697a5Ab7A501ED6fc02Bda096C66E70 0x130930e3E3D30bF8F975a729e948CdCc212ECFBB 0x61365C58E44A6Fc166897f4A30641dba82E606c0
    THRESHOLD=2
    ```

2. Администратор моста инициирует контракт моста, отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `updateLiquidityLimit` с параметром `(200000000000000000000)`.

3. Пользователь, чей приватный ключ соответствует адресу `0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e` отправляет 100 нативных токенов на адрес контракта моста. Транзакция исполняется успешно. Баланс пользователя уменьшается на 100 токенов. Баланс моста увеличивается до 100 токенов. В выписке транзакции есть событие:
    * `bridgeActionInitiated("0x79dD14623c4D33413c0c28fDAbC2285Fdb1e572e", 100000000000000000000)`

4. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Транзакция исполняется успешно. Баланс у пользователя `0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd` не меняется. Баланс контракта моста не меняется.

5. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.

6. Аккаунт с адресом `0x130930e3E3D30bF8F975a729e948CdCc212ECFBB` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xBeC92cb65ad0514eb8847a0c48Bd7ee4f6E88EeF ", 15000000000000000000, "0xeb096ea9048b5287eba951adda5b20a8eae9bf9dccc8ff34a44f984b0ed44fd2")`. Транзакция исполняется успешно. Баланс у пользователя `0xBeC92cb65ad0514eb8847a0c48Bd7ee4f6E88EeF` не меняется. Баланс контракта моста не меняется.

7. Аккаунт с адресом `0x61365C58E44A6Fc166897f4A30641dba82E606c0` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd", 50000000000000000000, "0xddfbb81ca5f813ff658bc60df9d23a464cec78966b90d98aa9c09ce4045bb285")`. Транзакция исполняется успешно. У пользователя `0xf712a82DD8e2Ac923299193e9d6dAEda2d5a32fd` после исполнения транзакции становится на 50 нативных токенов больше. Баланс контракта моста меняется до 50 нативных токенов.

8. Аккаунт с адресом `0x226Dbd003697a5Ab7A501ED6fc02Bda096C66E70` отправляет транзакцию на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающую метод `commit` с параметром `("0xBeC92cb65ad0514eb8847a0c48Bd7ee4f6E88EeF ", 15000000000000000000, "0xeb096ea9048b5287eba951adda5b20a8eae9bf9dccc8ff34a44f984b0ed44fd2")`. Транзакция исполняется успешно. У пользователя `0xBeC92cb65ad0514eb8847a0c48Bd7ee4f6E88EeF` после исполнения транзакции становится на 15 нативных токенов больше. Баланс контракта моста меняется до 35 нативных токенов.

9. Аккаунт с адресом `0x61365C58E44A6Fc166897f4A30641dba82E606c0` вызывает JSON RPC метод `eth_estimateGas` для оценки потребления газа перед посылкой транзакции на контракт `0x33E0E07cA86c869adE3fc9DE9126f6C73DAD105e`, вызывающей метод `commit` с параметром `("0xBeC92cb65ad0514eb8847a0c48Bd7ee4f6E88EeF ", 15000000000000000000, "0xeb096ea9048b5287eba951adda5b20a8eae9bf9dccc8ff34a44f984b0ed44fd2")`. Вызов `eth_estimateGas` возвращает ошибку, сообщающую о том, что в ходе вызова метода контракта выполнилась команда `revert`.
